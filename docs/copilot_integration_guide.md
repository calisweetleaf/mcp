# GitHub Copilot MCP Integration - Troubleshooting Guide

## üö® Common Issue: "Copilot doesn't see my tools"

**Root Cause**: Missing `.vscode/mcp.json` configuration file or incorrect setup.

## ‚úÖ Step-by-Step Fix

### 1. Create Required Configuration File

Create `.vscode/mcp.json` in your project root:

```json
{
  "servers": {
    "PersonalMCP": {
      "description": "Local sovereign MCP server with persistent memory, file operations, shell access, and cognitive session management",
      "command": "python",
      "args": ["mcp_server.py"],
      "transport": "stdio",
      "workingDirectory": "${workspaceFolder}",
      "env": {
        "PYTHONUNBUFFERED": "1",
        "MCP_SERVER_LOG_LEVEL": "INFO"
      }
    }
  }
}
```

### 2. Verify MCP Server Works

Run diagnostic script:
```bash
python debug_mcp_connection.py
```

Or test manually:
```bash
python mcp_server.py
# Then send JSON-RPC request:
{"jsonrpc": "2.0", "id": 1, "method": "initialize", "params": {"protocolVersion": "2024-11-05", "capabilities": {"tools": {}}}}
# Should respond with server info
```

### 3. Enable GitHub Copilot Agent Mode

In VS Code:
1. Open Settings (Ctrl+,)
2. Search: `chat.agent.enabled`
3. Set to `true`
4. Search: `chat.mcp.enabled` 
5. Set to `true`
6. **Restart VS Code completely**

### 4. Test Copilot Integration

1. Open Copilot Chat (Ctrl+Shift+I)
2. Switch to **Agent Mode** (look for dropdown/button)
3. Look for üîß **Tools** icon in chat interface
4. Should see "PersonalMCP" server with 46+ tools
5. Test with: `@workspace What tools do you have available?`

## üîç Debugging Checklist

### ‚ùå If Tools Still Don't Appear:

**Check VS Code Output Panel:**
- View ‚Üí Output ‚Üí Select "GitHub Copilot" or "MCP"
- Look for server startup logs or errors

**Common Issues:**

1. **Python path wrong**: Change `"command": "python"` to full path like `"C:\\Python311\\python.exe"`

2. **Working directory issue**: Verify `mcp_server.py` is in project root

3. **Agent Mode not enabled**: Must be in Agent Mode, not regular Chat mode

4. **Extension not installed**: Need both "GitHub Copilot" and "GitHub Copilot Chat" extensions

5. **VS Code version too old**: Need VS Code 1.99+ for Agent Mode

### ‚úÖ If Server Starts But Tools Don't Work:

Check tool definitions in `mcp_server.py`:
- Each tool needs proper `inputSchema`
- Descriptions must be clear for LLM understanding
- Parameter types must be correct

## üéØ Expected Behavior When Working

1. **VS Code Start**: MCP server starts automatically when needed
2. **Copilot Chat**: Shows tools icon with server listed
3. **Tool Discovery**: Copilot can see all 46+ tools
4. **Tool Usage**: Copilot automatically invokes tools based on user requests

## üìù Tool Manifest (Dynamic, Not Static)

**Important**: There is NO separate manifest file needed. Tools are discovered dynamically when Copilot calls the `tools/list` method on your MCP server.

Your `mcp_server.py` already implements this correctly with:
- `get_tool_manifest()` method
- Proper `tools/list` handler
- Complete tool schemas

## üöÄ Quick Test

If nothing else works, use the minimal test server generated by the debug script to isolate the issue.

## üìû Still Not Working?

1. Run `python debug_mcp_connection.py` and share output
2. Check VS Code Developer Tools (Help ‚Üí Toggle Developer Tools) for errors
3. Verify GitHub Copilot subscription is active
4. Try with a fresh VS Code workspace

The issue is almost always the missing `.vscode/mcp.json` file or incorrect VS Code/Copilot settings, not the MCP server code itself.
